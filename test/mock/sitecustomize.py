import ihm
try:
    import ihm.reference
except ImportError:
    pass
import os

# If we're running from an SGE job, override the from_pubmed_id() and
# from_accession() functions to return cached values, since we don't have
# network access (needed to query PubMed or UniProt directly)

def mock_from_pubmed(cls, pubmed_id):
    return ihm.Citation(
            pmid=32719457,
            title='Structural basis of CD4 downregulation by HIV-1 Nef',
            journal='Nat Struct Mol Biol', volume=None, page_range=None,
            year=2020, doi='10.1038/s41594-020-0463-z', authors=[
                'Kwon Y', 'Kaake RM', 'Echeverria I', 'Suarez M',
                'Karimian Shamsabadi M', 'Stoneham C', 'Ramirez PW',
                'Kress J', 'Singh R', 'Sali A', 'Krogan N,' 'Guatelli J',
                'Jia X'])

# Auto-generated by util/get_accession_map.py
accession_map = {
    'P03404': {'db_code':'NEF_HV1B1', 'sequence':
        'MGGKWSKSSVIGWPAVRERMRRAEPAADGVGAASRDLEKHGAITSSNTAANNAACAWLEAQEEEKV'
        'GFPVTPQVPLRPMTYKAAVDLSHFLKEKGGLEGLIHSQRRQDILDLWIYHTQGYFPDWQNYTPGPG'
        'IRYPLTFGWCYKLVPVEPDKVEEANKGENTSLLHPVSLHGMDDPEREVLEWRFDSRLAFHHVAREL'
        'HPEYFKNC'},
    'P01730': {'db_code':'CD4_HUMAN', 'sequence':
        'MNRGVPFRHLLLVLQLALLPAATQGKKVVLGKKGDTVELTCTASQKKSIQFHWKNSNQIKILGNQG'
        'SFLTKGPSKLNDRADSRRSLWDQGNFPLIIKNLKIEDSDTYICEVEDQKEEVQLLVFGLTANSDTH'
        'LLQGQSLTLTLESPPGSSPSVQCRSPRGKNIQGGKTLSVSQLELQDSGTWTCTVLQNQKKVEFKID'
        'IVVLAFQKASSIVYKKEGEQVEFSFPLAFTVEKLTGSGELWWQAERASSSKSWITFDLKNKEVSVK'
        'RVTQDPKLQMGKKLPLHLTLPQALPQYAGSGNLTLALEAKTGKLHQEVNLVVMRATQLQKNLTCEV'
        'WGPTSPKLMLSLKLENKEAKVSKREKAVWVLNPEAGMWQCLLSDSGQVLLESNIKVLPTWSTPVQP'
        'MALIVLGGVAGLLLFIGLGIFFCVRCRHRRRQAERMSQIKRLLSEKKTCQCPHRFQKTCSPI'},
    'P18484': {'db_code':'AP2A2_RAT', 'sequence':
        'MPAVSKGEGMRGLAVFISDIRNCKSKEAEIKRINKELANIRSKFKGDKALDGYSKKKYVCKLLFIF'
        'LLGHDIDFGHMEAVNLLSSNRYTEKQIGYLFISVLVNSNSELIRLINNAIKNDLASRNPTFMGLAL'
        'HCIANVGSREMAEAFAGEIPKILVAGDTMDSVKQSAALCLLRLYRTSPDLVPMGDWTSRVVHLLND'
        'QHLGVVTAATSLITTLAQKNPEEFKTSVSLAVSRLSRIVTSASTDLQDYTYYFVPAPWLSVKLLRL'
        'LQCYPPPDPAVRGRLTECLETILNKAQEPPKSKKVQHSNAKNAVLFEAISLIIHHDSEPNLLVRAC'
        'NQLGQFLQHRETNLRYLALESMCTLASSEFSHEAVKTHIETVINALKTERDVSVRQRAVDLLYAMC'
        'DRSNAQQIVAEMLSYLETADYSIREEIVLKVAILAEKYAVDYTWYVDTILNLIRIAGDYVSEEVWY'
        'RVIQIVINRDDVQGYAAKTVFEALQAPACHENLVKVGGYILGEFGNLIAGDPRSSPLIQFNLLHSK'
        'FHLCSVPTRALLLSTYIKFVNLFPEVKATIQDVLRSDSQLKNADVELQQRAVEYLRLSTVASTDIL'
        'ATVLEEMPPFPERESSILAKLKKKKGPSTVTDLEETKRERSIDVNGGPEPVPASTSAASTPSPSAD'
        'LLGLGAVPPAPTGPPPSSGGGLLVDVFSDSASAVAPLAPGSEDNFARFVCKNNGVLFENQLLQIGL'
        'KSEFRQNLGRMFIFYGNKTSTQFLNFTPTLICADDLQTNLNLQTKPVDPTVDGGAQVQQVINIECI'
        'SDFTEAPVLNIQFRYGGTFQNVSVKLPITLNKFFQPTEMASQDFFQRWKQLSNPQQEVQNIFKAKH'
        'PMDTEITKAKIIGFGSALLEEVDPNPANFVGAGIIHTKTTQIGCLLRLEPNLQAQMYRLTLRTSKD'
        'TVSQRLCELLSEQF'},
    'Q96CW1': {'db_code':'AP2M1_HUMAN', 'sequence':
        'MIGGLFIYNHKGEVLISRVYRDDIGRNAVDAFRVNVIHARQQVRSPVTNIARTSFFHVKRSNIWLA'
        'AVTKQNVNAAMVFEFLYKMCDVMAAYFGKISEENIKNNFVLIYELLDEILDFGYPQNSETGALKTF'
        'ITQQGIKSQHQTKEEQSQITSQVTGQIGWRREGIKYRRNELFLDVLESVNLLMSPQGQVLSAHVSG'
        'RVVMKSYLSGMPECKFGMNDKIVIEKQGKGTADETSKSGKQSIAIDDCTFHQCVRLSKFDSERSIS'
        'FIPPDGEFELMRYRTTKDIILPFRVIPLVREVGRTKLEVKVVIKSNFKPSLLAQKIEVRIPTPLNT'
        'SGVQVICMKGKAKYKASENAIVWKIKRMAGMKESQISAEIELLPTNDKKKWARPPISMNFEVPFAP'
        'SGLKVRYLKVFEPKLNYSDHDVIKWVRYIGRSGIYETRC'},
    'P53680': {'db_code':'AP2S1_HUMAN', 'sequence':
        'MIRFILIQNRAGKTRLAKWYMQFDDDEKQKLIEEVHAVVTVRDAKHTNFVEFRNFKIIYRRYAGLY'
        'FCICVDVNDNNLAYLEAIHNFVEVLNEYFHNVCELDLVFNFYKVYTVVDEMFLAGEIRETSQTKVL'
        'KQLLMLQSLE'},
    'P63010': {'db_code':'AP2B1_HUMAN', 'sequence':
        'MTDSKYFTTNKKGEIFELKAELNNEKKEKRKEAVKKVIAAMTVGKDVSSLFPDVVNCMQTDNLELK'
        'KLVYLYLMNYAKSQPDMAIMAVNSFVKDCEDPNPLIRALAVRTMGCIRVDKITEYLCEPLRKCLKD'
        'EDPYVRKTAAVCVAKLHDINAQMVEDQGFLDSLRDLIADSNPMVVANAVAALSEISESHPNSNLLD'
        'LNPQNINKLLTALNECTEWGQIFILDCLSNYNPKDDREAQSICERVTPRLSHANSAVVLSAVKVLM'
        'KFLELLPKDSDYYNMLLKKLAPPLVTLLSGEPEVQYVALRNINLIVQKRPEILKQEIKVFFVKYND'
        'PIYVKLEKLDIMIRLASQANIAQVLAELKEYATEVDVDFVRKAVRAIGRCAIKVEQSAERCVSTLL'
        'DLIQTKVNYVVQEAIVVIRDIFRKYPNKYESIIATLCENLDSLDEPDARAAMIWIVGEYAERIDNA'
        'DELLESFLEGFHDESTQVQLTLLTAIVKLFLKKPSETQELVQQVLSLATQDSDNPDLRDRGYIYWR'
        'LLSTDPVTAKEVVLSEKPLISEETDLIEPTLLDELICHIGSLASVYHKPPNAFVEGSHGIHRKHLP'
        'IHHGSTDAGDSPVGTTTATNLEQPQVIPSQGDLLGDLLNLDLGPPVNVPQVSSMQMGAVDLLGGGL'
        'DSLVGQSFIPSSVPATFAPSPTPAVVSSGLNDLFELSTGIGMAPGGYVAPKAVWLPAVKAKGLEIS'
        'GTFTHRQGHIYMEMNFTNKALQHMTDFAIQFNKNSFGVIPSTPLAIHTPLMPNQSIDVSLPLNTLG'
        'PVMKMEPLNNLQVAVKNNIDVFYFSCLIPLNVLFVEDGKMERQVFLATWKDIPNENELQFQIKECH'
        'LNADTVSSKLQNNNVYTIAKRNVEGQDMLYQSLKLTNGIWILAELRIQPGNPNYTLSLKCRAPEVS'
        'QYIYQVYDSILKN'},
}

if 'JOB_ID' in os.environ:
    ihm.Citation.from_pubmed_id = classmethod(mock_from_pubmed)
    if hasattr(ihm, 'reference'):
        def from_acc(cls, accession):
            return cls(accession=accession, **accession_map[accession])
        ihm.reference.UniProtSequence.from_accession = classmethod(from_acc)
